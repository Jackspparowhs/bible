<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>The Bible ‚Äî PirateRuler.com</title>
<meta name="description" content="The Bible by PirateRuler.com ‚Äî offline, simple reader using image pages (no API)" />
<style>
  /* Minimal theme that matches your site style (dark/light via html.light) */
  :root{
    --bg-dark: linear-gradient(180deg,#061028 0%, #071225 50%);
    --bg-light: linear-gradient(180deg,#f7fbfe,#f3f7fb);
    --card-dark: rgba(255,255,255,0.02);
    --muted-dark: #98a7bf;
    --muted-light: #6b7480;
    --accent-a: #6b7dff;
    --accent-b: #7b4bff;
    --text-light: #e9f1ff;
    --text-dark: #071225;
    --max-w: 1100px;
    --radius: 14px;
  }
  html.light { --bg: var(--bg-light); --muted: var(--muted-light); --text: var(--text-dark); --offbg: #fff; }
  html         { --bg: var(--bg-dark);  --muted: var(--muted-dark); --text: var(--text-light); --offbg: #061028; }

  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--bg); color:var(--text); padding:18px; -webkit-font-smoothing:antialiased}
  a{color:inherit}
  .wrap{max-width:var(--max-w);margin:0 auto}

  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--accent-a),var(--accent-b));color:#fff;font-weight:900}
  .title{font-weight:900;font-size:18px}
  .sub{font-size:12px;color:var(--muted)}

  .controls{display:flex;gap:10px;align-items:center}
  .theme-btn{width:46px;height:46px;border-radius:12px;border:0;background:var(--offbg);cursor:pointer;font-size:18px}

  main{display:block}
  .intro{background:var(--offbg);padding:18px;border-radius:12px;margin-bottom:18px;box-shadow:0 10px 30px rgba(0,0,0,0.25)}
  .intro h1{margin:0 0 8px 0;font-size:20px}
  .intro p{margin:0;color:var(--muted);font-size:14px}

  /* books grid */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-top:18px}
  .book-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:8px;min-height:110px;justify-content:center}
  .book-icon{width:72px;height:72;border-radius:12px;background:linear-gradient(135deg,var(--accent-a),var(--accent-b));display:flex;align-items:center;justify-content:center;color:white;font-weight:900;font-size:16px}
  .book-name{font-weight:800;text-align:center;font-size:13px}
  .chap-count{font-size:12px;color:var(--muted)}

  /* modal / viewer */
  .modal{position:fixed;left:0;top:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;padding:18px;z-index:999}
  .modal.open{display:flex}
  .modal-bg{position:absolute;inset:0;backdrop-filter:blur(3px);background:rgba(0,0,0,0.45)}
  .viewer{position:relative;max-width:980px;width:100%;max-height:92vh;background:var(--offbg);border-radius:12px;padding:14px;overflow:hidden;z-index:10;box-shadow:0 20px 60px rgba(0,0,0,0.6);display:flex;flex-direction:column}
  .viewer-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px}
  .viewer-title{font-weight:900}
  .viewer-controls{display:flex;gap:8px;align-items:center}
  .btn{padding:8px 12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent-a),var(--accent-b));color:#fff;font-weight:800;cursor:pointer}
  .btn-ghost{padding:8px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--muted);cursor:pointer}

  .image-wrap{flex:1;display:flex;align-items:center;justify-content:center;overflow:auto;background:transparent;border-radius:8px;padding:6px}
  .page-img{max-width:100%;max-height:78vh;border-radius:6px;box-shadow:0 8px 20px rgba(0,0,0,0.4);background:#fff}

  .thumb-row{display:flex;gap:8px;overflow:auto;padding-top:10px;margin-top:8px}
  .thumb{width:72px;height:88px;border-radius:6px;flex:0 0 auto;overflow:hidden;border:1px solid rgba(0,0,0,0.06);display:flex;align-items:center;justify-content:center}
  .thumb img{width:100%;height:100%;object-fit:cover}

  /* helper text */
  .hint{font-size:13px;color:var(--muted);margin-top:8px}

  @media (max-width:720px){
    .viewer{padding:10px}
    .book-name{font-size:12px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">PR</div>
        <div>
          <div class="title">Bible</div>
          <div class="sub">by PirateRuler.com</div>
        </div>
      </div>

      <div class="controls">
        <button id="themeBtn" class="theme-btn" title="Toggle theme">‚òÄÔ∏è</button>
      </div>
    </header>

    <main>
      <section class="intro">
        <h1>Open a book ‚Üí chapter to view image pages</h1>
        <p class="hint">Setup: place your scanned/screenshot pages in folders named <code>books/&lt;slug&gt;/&lt;chapter&gt;.jpg</code>. Example: <code>books/genesis/1.jpg</code>, <code>books/psalms/23.jpg</code>. See full naming rules below.</p>
      </section>

      <!-- Books grid generated by JS -->
      <div id="booksGrid" class="grid" aria-live="polite"></div>

      <p style="margin-top:18px;color:var(--muted);font-size:13px">
        Naming & location (very important):
        <ul>
          <li>Put folders under <code>/books/</code> on the same site hosting this page.</li>
          <li>Each book folder uses the <strong>slug</strong> (see list used by this page), then files named <code>1.jpg</code>, <code>2.jpg</code> ... for chapters.</li>
          <li>Supported image formats: <code>.jpg</code>, <code>.png</code>. Use smallish optimized images (600‚Äì1200px wide) for fast mobile load.</li>
        </ul>
      </p>
    </main>
  </div>

  <!-- modal viewer -->
  <div id="modal" class="modal" role="dialog" aria-hidden="true">
    <div class="modal-bg" id="modalBg"></div>
    <div class="viewer" role="document" aria-modal="true">
      <div class="viewer-header">
        <div>
          <div id="viewerTitle" class="viewer-title">‚Äî</div>
          <div id="viewerSubtitle" style="font-size:13px;color:var(--muted)"></div>
        </div>
        <div class="viewer-controls">
          <button id="prevBtn" class="btn-ghost" title="Previous chapter">‚óÄ Prev</button>
          <button id="nextBtn" class="btn-ghost" title="Next chapter">Next ‚ñ∂</button>
          <button id="closeBtn" class="btn" title="Close">Close</button>
        </div>
      </div>

      <div class="image-wrap" id="imageWrap">
        <img id="pageImage" class="page-img" alt="Bible page" src="" />
      </div>

      <div class="thumb-row" id="thumbRow" aria-hidden="false"></div>
    </div>
  </div>

<script>
/* =========================
   BOOK LIST & CHAPTER COUNTS
   (Protestant order) - slugs used for folders
   ========================= */
const BOOKS = [
  {slug:'genesis', name:'Genesis', chapters:50},
  {slug:'exodus', name:'Exodus', chapters:40},
  {slug:'leviticus', name:'Leviticus', chapters:27},
  {slug:'numbers', name:'Numbers', chapters:36},
  {slug:'deuteronomy', name:'Deuteronomy', chapters:34},
  {slug:'joshua', name:'Joshua', chapters:24},
  {slug:'judges', name:'Judges', chapters:21},
  {slug:'ruth', name:'Ruth', chapters:4},
  {slug:'1-samuel', name:'1 Samuel', chapters:31},
  {slug:'2-samuel', name:'2 Samuel', chapters:24},
  {slug:'1-kings', name:'1 Kings', chapters:22},
  {slug:'2-kings', name:'2 Kings', chapters:25},
  {slug:'1-chronicles', name:'1 Chronicles', chapters:29},
  {slug:'2-chronicles', name:'2 Chronicles', chapters:36},
  {slug:'ezra', name:'Ezra', chapters:10},
  {slug:'nehemiah', name:'Nehemiah', chapters:13},
  {slug:'esther', name:'Esther', chapters:10},
  {slug:'job', name:'Job', chapters:42},
  {slug:'psalms', name:'Psalms', chapters:150},
  {slug:'proverbs', name:'Proverbs', chapters:31},
  {slug:'ecclesiastes', name:'Ecclesiastes', chapters:12},
  {slug:'song-of-solomon', name:'Song of Solomon', chapters:8},
  {slug:'isaiah', name:'Isaiah', chapters:66},
  {slug:'jeremiah', name:'Jeremiah', chapters:52},
  {slug:'lamentations', name:'Lamentations', chapters:5},
  {slug:'ezekiel', name:'Ezekiel', chapters:48},
  {slug:'daniel', name:'Daniel', chapters:12},
  {slug:'hosea', name:'Hosea', chapters:14},
  {slug:'joel', name:'Joel', chapters:3},
  {slug:'amos', name:'Amos', chapters:9},
  {slug:'obadiah', name:'Obadiah', chapters:1},
  {slug:'jonah', name:'Jonah', chapters:4},
  {slug:'micah', name:'Micah', chapters:7},
  {slug:'nahum', name:'Nahum', chapters:3},
  {slug:'habakkuk', name:'Habakkuk', chapters:3},
  {slug:'zephaniah', name:'Zephaniah', chapters:3},
  {slug:'haggai', name:'Haggai', chapters:2},
  {slug:'zechariah', name:'Zechariah', chapters:14},
  {slug:'malachi', name:'Malachi', chapters:4},
  {slug:'matthew', name:'Matthew', chapters:28},
  {slug:'mark', name:'Mark', chapters:16},
  {slug:'luke', name:'Luke', chapters:24},
  {slug:'john', name:'John', chapters:21},
  {slug:'acts', name:'Acts', chapters:28},
  {slug:'romans', name:'Romans', chapters:16},
  {slug:'1-corinthians', name:'1 Corinthians', chapters:16},
  {slug:'2-corinthians', name:'2 Corinthians', chapters:13},
  {slug:'galatians', name:'Galatians', chapters:6},
  {slug:'ephesians', name:'Ephesians', chapters:6},
  {slug:'philippians', name:'Philippians', chapters:4},
  {slug:'colossians', name:'Colossians', chapters:4},
  {slug:'1-thessalonians', name:'1 Thessalonians', chapters:5},
  {slug:'2-thessalonians', name:'2 Thessalonians', chapters:3},
  {slug:'1-timothy', name:'1 Timothy', chapters:6},
  {slug:'2-timothy', name:'2 Timothy', chapters:4},
  {slug:'titus', name:'Titus', chapters:3},
  {slug:'philemon', name:'Philemon', chapters:1},
  {slug:'hebrews', name:'Hebrews', chapters:13},
  {slug:'james', name:'James', chapters:5},
  {slug:'1-peter', name:'1 Peter', chapters:5},
  {slug:'2-peter', name:'2 Peter', chapters:3},
  {slug:'1-john', name:'1 John', chapters:5},
  {slug:'2-john', name:'2 John', chapters:1},
  {slug:'3-john', name:'3 John', chapters:1},
  {slug:'jude', name:'Jude', chapters:1},
  {slug:'revelation', name:'Revelation', chapters:22}
];

/* ============
   Helper: build grid
   ============ */
const grid = document.getElementById('booksGrid');
BOOKS.forEach(book => {
  const card = document.createElement('button');
  card.className = 'book-card';
  card.type = 'button';
  card.innerHTML = `
    <div class="book-icon">${book.name.split(' ').map(w=>w[0]).slice(0,2).join('')}</div>
    <div class="book-name">${book.name}</div>
    <div class="chap-count">${book.chapters} chapters</div>
  `;
  card.addEventListener('click', () => openBook(book));
  grid.appendChild(card);
});

/* ============
   Viewer logic
   - expects images at /books/<slug>/<n>.(jpg|png)
   - lazy loads first chapter images, and builds thumbs for available chapters (tries jpg then png)
   ============ */
const modal = document.getElementById('modal');
const modalBg = document.getElementById('modalBg');
const viewerTitle = document.getElementById('viewerTitle');
const viewerSubtitle = document.getElementById('viewerSubtitle');
const pageImage = document.getElementById('pageImage');
const thumbRow = document.getElementById('thumbRow');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const closeBtn = document.getElementById('closeBtn');

let currentBook = null;
let currentChapter = 1;

function openBook(book){
  currentBook = book;
  currentChapter = 1;
  viewerTitle.textContent = `${book.name}`;
  viewerSubtitle.textContent = `Chapter ${currentChapter} / ${book.chapters}`;
  buildThumbs(book);
  showChapter(currentChapter);
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
  // focus first for keyboard nav
  closeBtn.focus();
}

modalBg.addEventListener('click', closeModal);
closeBtn.addEventListener('click', closeModal);
document.addEventListener('keydown', (e) => {
  if(modal.classList.contains('open')){
    if(e.key === 'Escape') closeModal();
    if(e.key === 'ArrowRight') nextChapter();
    if(e.key === 'ArrowLeft') prevChapter();
  }
});

function closeModal(){
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
  pageImage.src = '';
  thumbRow.innerHTML = '';
  currentBook = null;
}

/* build thumbnails (generates img elements that will try jpg then png) */
function buildThumbs(book){
  thumbRow.innerHTML = '';
  for(let i=1;i<=book.chapters;i++){
    const t = document.createElement('div');
    t.className = 'thumb';
    const img = document.createElement('img');
    img.alt = `${book.name} ${i}`;
    img.loading = 'lazy';
    // set small preview path; we'll try both jpg and png with fallback loader
    const base = `/books/${book.slug}/${i}`;
    img.dataset.base = base;
    img.dataset.num = i;
    img.src = `${base}.jpg`;
    img.onerror = () => {
      if(img.src.endsWith('.jpg')) img.src = `${base}.png`;
      else {
        // missing - show tiny placeholder SVG data URI
        img.src = placeholderDataURI(book.name + ' ' + i, 72, 88);
      }
    };
    img.addEventListener('click', ()=>{ showChapter(i); scrollThumbIntoView(img) });
    t.appendChild(img);
    thumbRow.appendChild(t);
  }
}

/* display full-size chapter image (try jpg then png if 404) */
function showChapter(n){
  if(!currentBook) return;
  currentChapter = n;
  viewerSubtitle.textContent = `Chapter ${currentChapter} / ${currentBook.chapters}`;
  const base = `/books/${currentBook.slug}/${n}`;
  // first try jpg then png then placeholder
  pageImage.src = `${base}.jpg`;
  pageImage.onerror = () => {
    if(pageImage.src.endsWith('.jpg')) pageImage.src = `${base}.png`;
    else pageImage.src = placeholderDataURI('No image', 800, 1000);
  };
}

/* next / prev */
function nextChapter(){ if(currentBook && currentChapter < currentBook.chapters) showChapter(currentChapter+1); }
function prevChapter(){ if(currentBook && currentChapter > 1) showChapter(currentChapter-1); }
prevBtn.addEventListener('click', prevChapter);
nextBtn.addEventListener('click', nextChapter);

/* scroll thumb into visible area */
function scrollThumbIntoView(img){
  try{ img.scrollIntoView({behavior:'smooth',inline:'center'}); }catch(e){}
}

/* placeholder generator (simple SVG data URI) */
function placeholderDataURI(text,w=200,h=260){
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}'><rect width='100%' height='100%' fill='#eee'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Arial, sans-serif' font-size='14' fill='#999'>${escapeHtml(text)}</text></svg>`;
  return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
}
function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

/* theme toggle (switch html.light class) */
const themeBtn = document.getElementById('themeBtn');
themeBtn.addEventListener('click', () => {
  const html = document.documentElement;
  if(html.classList.contains('light')) {
    html.classList.remove('light');
    localStorage.setItem('pr-theme', 'dark');
    themeBtn.textContent = 'üåô';
  } else {
    html.classList.add('light');
    localStorage.setItem('pr-theme', 'light');
    themeBtn.textContent = '‚òÄÔ∏è';
  }
});
// initialize theme from localStorage
(function initTheme(){
  const saved = localStorage.getItem('pr-theme') || 'light';
  if(saved === 'light') document.documentElement.classList.add('light'), themeBtn.textContent='‚òÄÔ∏è';
  else document.documentElement.classList.remove('light'), themeBtn.textContent='üåô';
})();

/* small helper: try to preload a chapter image (optional) */
function preloadChapter(bookSlug, n){
  const img = new Image();
  img.src = `/books/${bookSlug}/${n}.jpg`;
  img.onerror = function(){ img.src = `/books/${bookSlug}/${n}.png` };
}

/* accessibility: close modal when orientation / back click on phones (optional) */
window.addEventListener('pagehide', ()=>{ if(modal.classList.contains('open')) closeModal(); });

</script>
</body>
</html>
